<!DOCTYPE html>
<meta charset="UTF-8">
<body>
    <div id="disp">
        <div class="aaa">안졸리나 로제</div>
        <div class="aaa ccc">안졸리나 제니</div>
        <div class="aaa">안졸리나 리사</div>
        <div class="aaa ccc">안졸리나 지수</div>
    </div>
</body>
<script>
    (function(){
        // alert("난 부르지 않아도 실행되요!")
        //즉각 실행함수 형태로 핵심 코드 보호
        // var $;처럼 따로 빼서 선언하지않고 묶어서 선언하고 싶어함 
        // new 키워드를 없애고 싶었던 jQuery 개발팀
        var $ = function(p_sel){
            return new myDom(p_sel);
        }
        var myDom = function(p_sel) {
            var v_elems = document.querySelectorAll(p_sel);
            this.length = v_elems.length;
            for(var i=0;i<v_elems.length;i++){
                this[i] = v_elems[i];
            }
            return this;    // 이것으로 myDom함수는 class로 쓰려는의미가 담겨있음
        }
        // 메소드를 추가하려면 아래 처럼 해야 되는데
        // 이것이 핵심코드 영역을 침범하게 내버려두는 것 처럼 보여서 아주 싫음
        // 더구나 개발자들이 자신들이 필요한 메소드를 추가하고픈 상황에도
        // 적절치 않아 보여 prototype을 밖으로 꺼내기로 함.
        // myDom.prototype.메소드명 = function(){}

        window.$=$; // 전역변수 $와 지역변수 $가 참조방식으로 연결됨
        $.fn= myDom.prototype;  // prototype속성을 fn속성으로 밖으로 꺼냄
    })();
    // 이제 즉각 실행 함수 밖에서도 메소드를 추가할 수 있게 됨
    // 보통 제공되는 거 외에 개발자가 추가하는 속성/메소드를 jQuery플러그인이라 부름
    $.fn.eq = function(p_index){    // eq 메소드 추가
        return this[p_index];
    }
    // jQuery에서 자주 쓰는 메소드 만들어보기
    // 먼저 html 메소드-> innerHTML 속성을 편하게 제어해 주는 메소드
    $.fn.html = function(p_arg){
        if(!p_arg){ // 매개변수 값 없이 불러졌을때, 읽기를 위함
            // jQuery개발팀은 그냥 첫번째 선택된 것의 innerHTML을 리턴하기로 함
            return this[0].innerHTML;
        }
        if(typeof(p_arg) == "string"){
            for(var i=0;i<this.length;i++){
                this[i].innerHTML = p_arg;
            }
        }
        if(typeof(p_arg) == "function"){
            for(var i=0;i<this.length;i++){
               this[i].innerHTML= p_arg(i,this[i].innerHTML);
            }
        }
    }
    


    // var v_dom1 = new myDom("#disp");
    // jQuery 잘 쓰려면 css 선택자 다시 공부해 오기
    var v_dom2 = $(".aaa"); // new없이 부를 수 있음
    v_dom2.html(function(p_inx,p_html){
        // alert(p_inx +":"+ p_html);
        if(p_inx == 1){
            return "난 정말 자바스크립트가 너무 안쉬워요~!~"
        }
        return p_html;  //원래 값 그대로
    })
    // console.log(v_dom2.html("최고 프로그래머"));   // 눈으로 확인
</script>
